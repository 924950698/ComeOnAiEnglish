<!--社交功能页面-->
<view class="container">
  <!-- 顶部信息 -->
  <view class="header">
    <view class="back-btn" bindtap="goBack">
      <text class="back-icon">←</text>
    </view>
    <view class="title">好友挑战</view>
    <view class="placeholder"></view>
  </view>

  <!-- 邀请好友 -->
  <view class="invite-section">
    <view class="invite-card">
      <view class="invite-icon">👥</view>
      <view class="invite-content">
        <view class="invite-title">邀请好友一起学习</view>
        <view class="invite-desc">邀请好友可获得积分奖励，一起进步更有趣</view>
        <view class="invite-stats">
          <text class="invite-count">已邀请: {{inviteCount}}人</text>
          <text class="invite-reward">获得: {{inviteReward}}积分</text>
        </view>
      </view>
      <view class="invite-btn" bindtap="inviteFriend">
        <text class="btn-text">邀请</text>
      </view>
    </view>
  </view>

  <!-- 好友列表 -->
  <view class="friends-section">
    <view class="section-title">👥 我的好友</view>
    <view class="friends-list" wx:if="{{friends.length > 0}}">
      <view class="friend-item" wx:for="{{friends}}" wx:key="id">
        <view class="friend-avatar">
          <image src="{{item.avatar}}" class="avatar-img"></image>
          <view class="online-status {{item.online ? 'online' : 'offline'}}"></view>
        </view>
        <view class="friend-info">
          <view class="friend-name">{{item.name}}</view>
          <view class="friend-level">Lv.{{item.level}}</view>
          <view class="friend-score">积分: {{item.score}}</view>
        </view>
        <view class="friend-actions">
          <view class="action-btn challenge-btn" bindtap="challengeFriend" data-id="{{item.id}}">
            <text class="btn-text">挑战</text>
          </view>
        </view>
      </view>
    </view>
    <view class="empty-friends" wx:else>
      <view class="empty-icon">👥</view>
      <view class="empty-text">还没有好友</view>
      <view class="empty-desc">快去邀请好友一起学习吧</view>
    </view>
  </view>

  <!-- 排行榜 -->
  <view class="ranking-section">
    <view class="section-title">🏆 排行榜</view>
    <view class="ranking-tabs">
      <view class="tab-item {{currentRankTab === 'weekly' ? 'active' : ''}}" 
            bindtap="switchRankTab" 
            data-tab="weekly">本周</view>
      <view class="tab-item {{currentRankTab === 'monthly' ? 'active' : ''}}" 
            bindtap="switchRankTab" 
            data-tab="monthly">本月</view>
      <view class="tab-item {{currentRankTab === 'all' ? 'active' : ''}}" 
            bindtap="switchRankTab" 
            data-tab="all">总榜</view>
    </view>
    
    <view class="ranking-list">
      <view class="rank-item {{item.isMe ? 'my-rank' : ''}}" 
            wx:for="{{rankingList}}" 
            wx:key="id">
        <view class="rank-number">
          <text class="rank-text" wx:if="{{item.rank <= 3}}">{{item.rank}}</text>
          <text class="rank-icon" wx:else>{{item.rank}}</text>
        </view>
        <view class="rank-avatar">
          <image src="{{item.avatar}}" class="avatar-img"></image>
          <view class="rank-badge" wx:if="{{item.rank <= 3}}">
            <text class="badge-icon">🏆</text>
          </view>
        </view>
        <view class="rank-info">
          <view class="rank-name">{{item.name}}</view>
          <view class="rank-level">Lv.{{item.level}}</view>
        </view>
        <view class="rank-score">{{item.score}}</view>
      </view>
    </view>
  </view>

  <!-- 挑战记录 -->
  <view class="challenge-section">
    <view class="section-title">⚔️ 挑战记录</view>
    <view class="challenge-list" wx:if="{{challenges.length > 0}}">
      <view class="challenge-item" wx:for="{{challenges}}" wx:key="id">
        <view class="challenge-info">
          <view class="challenge-type">{{item.type}}</view>
          <view class="challenge-opponent">vs {{item.opponent}}</view>
          <view class="challenge-time">{{item.time}}</view>
        </view>
        <view class="challenge-result {{item.result}}">
          <text class="result-text">{{item.resultText}}</text>
        </view>
        <view class="challenge-score">
          <text class="my-score">{{item.myScore}}</text>
          <text class="vs-text">vs</text>
          <text class="opponent-score">{{item.opponentScore}}</text>
        </view>
      </view>
    </view>
    <view class="empty-challenges" wx:else>
      <view class="empty-icon">⚔️</view>
      <view class="empty-text">还没有挑战记录</view>
      <view class="empty-desc">快去挑战好友吧</view>
    </view>
  </view>

  <!-- 每日任务 -->
  <view class="tasks-section">
    <view class="section-title">📋 每日任务</view>
    <view class="tasks-list">
      <view class="task-item {{item.completed ? 'completed' : ''}}" 
            wx:for="{{dailyTasks}}" 
            wx:key="id">
        <view class="task-icon">{{item.icon}}</view>
        <view class="task-content">
          <view class="task-name">{{item.name}}</view>
          <view class="task-desc">{{item.description}}</view>
          <view class="task-progress" wx:if="{{!item.completed}}">
            <view class="progress-bar">
              <view class="progress-fill" style="width: {{item.progress}}%"></view>
            </view>
            <text class="progress-text">{{item.current}}/{{item.target}}</text>
          </view>
        </view>
        <view class="task-reward">
          <text class="reward-icon">💎</text>
          <text class="reward-number">{{item.reward}}</text>
        </view>
      </view>
    </view>
  </view>
</view>
